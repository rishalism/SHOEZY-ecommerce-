<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>shoezy</title>
</head>
<link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
<link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
<!------ Include the above in your HEAD tag ---------->

<style>
  .form-gap {
    padding-top: 70px;
  }
  body{
    height: 100dvb;
  }
</style>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

</html>

<div class="form-gap"></div>
<div class="container">
  <div class="row">
    <div class="col-md-4 col-md-offset-4">
      <div class="panel panel-default">
        <div class="panel-body" style="box-shadow: 0px 10px 63px -3px rgba(0,0,0,0.1); border-radius: 10px;">
          <div class="text-center">
            <h3><i class="fa fa-lock fa-4x"></i></h3>
            <h2 class="text-center">Forgot Password?</h2>
            <p>You can reset your password here.</p>
            <div id="error-message" class="text-center text-danger"></div>
            <div class="panel-body">
              <form id="register-form" role="form" autocomplete="off" class="form">

                <div class="form-group">
                  <div class="input-group">
                    <span class="input-group-addon"><i class="glyphicon glyphicon-envelope color-blue"></i></span>
                    <input id="email" name="email" placeholder="enter email address" class="form-control" type="email">
                  </div>
                </div>
                <div class="form-group">
                  <input name="recover-submit" id="reset-password" class="btn btn-lg btn-primary btn-block"
                    value="Reset Password" type="button">
                </div>
                <div><a href="/register">signup</a</div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>

const otp = async ()=>{

  const { value: ipAddress } = await Swal.fire({
  title: "Enter your IP address",
  input: "text",
  inputLabel: "Your IP address",
  inputValue,
  showCancelButton: true,
  inputValidator: (value) => {
    if (!value) {
      return "You need to write something!";
    }
  }
});
if (ipAddress) {
  Swal.fire(`Your IP address is ${ipAddress}`);
}

}


document.getElementById('reset-password').addEventListener('click',()=>{
 const email =  document.getElementById('email').value
     fetch('/forgot-password',{
      method : 'POST',
      headers : {
        'Content-Type': 'application/json',
      },
      body : JSON.stringify({
        email
      })
     }).then(response=>{
      return response.json()
     }).then(data=>{
      if(data){
        let value  = data.value

        if(value==0){
        document.getElementById('error-message').textContent = 'Email is not registered'
        }else{
          otp()
        }
      
      }
     }).catch(error=>{
      console.log(error);
     })
 
})

</script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>